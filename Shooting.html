<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Shooting Game</title>
    <style>* { padding: 0; margin: 0; }
        canvas { background: #000; }
    </style>
</head>
<body>
    <canvas></canvas>
    <script>
        // Press right or d key, Triangle moves right
        // Press left  or a key, left.
        
        var canvas = document.querySelector('canvas');
        var endX = canvas.width = window.innerWidth;
        var endY = canvas.height = window.innerHeight;
        var c = canvas.getContext('2d');
        var midX = endX/2;
        var midY = endY/2;
        c.lineWidth = 2;
        
        // Players Starting point
        var pX = midX; var pY = endY - 60;
        var right = false; var left = false;
        
        // Bullets starting point
        var bX = pX; var bY = pY;
        
        // Players width and height
        var pW = 40; var pH = 80;
        // Bullets width
        var bW = 10; var eBW = 20;
        // Enemy's Starting point
        var eX = endX/2; var eY = endY/3;
        var eW = 60; var eH = 120;
        // Enemy's bullet's starting point
        var eBX = eX; var eBY = eY;
        // Enemy Direction
        var drc = 1;
        
        var pSpd = 12; var eSpd = 10;
        var bSpd = 48; var eBSpd = 24;
        
        var eHP = 100;
        var point = 0;
        

        function drawPlayer() {
            c.beginPath();
            c.strokeStyle = '#fff';
            c.moveTo(pX, pY);
            c.lineTo(pX + pW,pY + pH);
            c.lineTo(pX - pW,pY + pH);
            c.lineTo(pX,pY);
            c.stroke();
            c.fillStyle = '#0095DD';
            c.fill();
            c.closePath();
            if (right&& pX+pSpd < endX)
                pX += pSpd;
            else if (left && pSpd<pX)
                pX -= pSpd;
        }
        function drawBul() {
            c.beginPath();
            c.fillStyle = '#bbb';
            c.arc(bX,bY,bW,0,10,false);
            c.stroke();
            c.fill();
            c.closePath();

            if(bY < 0) {
                bX = pX;bY = pY;
            } else {
                bY -= bSpd;
            } 
        }
        function drawEne() {
            c.beginPath();
            c.strokeStyle = '#000';
            c.moveTo(eX, eY);
            c.lineTo(eX - eW,eY - eH);
            c.lineTo(eX + eW,eY - eH);
            c.lineTo(eX,eY);
            c.stroke();
            c.fillStyle = '#d00';
            c.fill();
            c.closePath();
            eX += eSpd * drc;
            if (endX < eX) 
                drc *= -1;
            if (eX < 0)
                drc *= -1;
        }
        function drawEneBul() {
            c.beginPath();
            c.fillStyle = '#f00';
            c.arc(eBX,eBY,eBW,0,10,false);
            c.stroke();
            c.fill();
            c.closePath();

            if(eBY > endY) {
                eBX = eX;eBY = eY;
            } else {
                eBY += eBSpd;
            } 
        }

        function draw() {
            c.clearRect(0,0,endX,endY);
            drawPlayer();
            drawBul();
            drawEne();
            drawEneBul();
            drawMessage();
            hit();
            
            console.log("pX: "+pX);
            //console.log("bY: "+bY);
            console.log('eBX : ' + eBX);
        requestAnimationFrame(draw);
        } draw();
        document.addEventListener("keydown", KeyDownHandler, false);
        document.addEventListener("keyup", KeyUpHandler, false);

        function KeyDownHandler(e) {
            // right key or D key
            // left key or A key
            if(e.keyCode == 39||e.keyCode == 68) { 
                right = true;
            } else if(e.keyCode == 37||e.keyCode == 65) {
                left = true;
            }
        }
        function KeyUpHandler(e) {
            if (e.keyCode == 39||e.keyCode == 68) {
                right = false;
            } else if (e.keyCode == 37||e.keyCode == 65) {
                left = false;
            }
        }
        function drawMessage() {
        c.beginPath();
        c.fillStyle = '#fff';
        c.textAlign = "center";
        c.font = '75px serif';
        c.fillText('Press D(<-) or A(->)  HP:'+eHP,midX,endY*.1);
        }
        function hit() {
            if (bX>eX&& bX<eX+eW&& bY<eY&&bY<eY+eH) 
                eHP -= 1;
            if (eHP < 0)
                c.fillText("CLEAR!",midX,midY,500);
        }
    </script>
</body>
</html>